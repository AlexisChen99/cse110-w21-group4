<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Potato Timer</title>
    <link rel="stylesheet" href="potatoTheme.css">
    <link rel="icon" type="image/png" href="img/potatoIcon.png">
    <script src="app.js"></script>
</head>

<body id="background">
    <div class="contentWrapper">
        <p id="title">Potato Timer</p>

        <p id="phaseDisplay">Work</p>
        <img src="img/settings.png" alt="Settings" id="settingsIcon">

        <div id="circleTimer">
            <p class="timer" id="timerDisplay">25:00</p>
        </div>

        <div class="buttonWrapper">
            <button id="reset" onclick="reset()">Reset</button>
            <button id="start" onclick="start()">Start</button>
            <button id="tasks" onclick="displayTasks()">Tasks</button>
        </div>

        <div class="taskContainer">
            <input type="text" id="enterTask" placeholder="Enter Task" required>
            <button id="taskAdder" onclick="addTask()">Add</button>
        </div>
        <div id="mainTasks">

        </div>

        <!-- End of content wrapper -->
    </div>

    <div class="menu" id="settingsMenu">
        <p>Settings</p>
        <p class="close" id="closeSettings">Close</p>
        <div id="chooseTheme">
            <p style="margin: 0 0; font-size: 18px;">Select a Theme</p>
            <button id="themeDark" onclick="lightTheme()">Light</button>
            <button id="themeDark" onclick="darkTheme()">Dark</button>
            <button id="themePotato" onclick="potatoTheme()">Potato</button>
        </div>

        <form class="userInputContainer">
            <div>
                <label for="work" class="fieldLabel">Work Time</label>
                <input type="number" class="customTime" id="workMin" value="25">
                <p>:</p>
                <input type="number" class="customTime" id="workSec" value="00">
            </div>

            <div>
                <label for="shortBreak" class="fieldLabel">Short Break</label>
                <input type="number" class="customTime" id="shortMin" value="5">
                <p>:</p>
                <input type="number" class="customTime" id="shortSec" value="00">
            </div>

            <div>
                <label for="longBreak" class="fieldLabel">Long Break</label>
                <input type="number" class="customTime" id="longMin" value="25">
                <p>:</p>
                <input type="number" class="customTime" id="longSec" value="00">
            </div>
            <div>
                <label for="volume" class="fieldLabel">Volume (%)</label>
                <input type="number" class="customVolume" id="volume" value="50">
                <img src="img/volume.png" alt="Mute?" id="volumeIcon">
            </div>
        </form>
        <!-- End of settings menu -->
    </div>

    <div class="menu" id="taskMenu">
        <p>Tasks</p>
        <p class="close" id="closeTasks">Close</p>
        <p id="deleteAll">Delete All</p>
        <div id="taskListContainer">

        </div>
    </div>

</body>

<script>
    window.onload = function () {
        const settings = document.getElementById("settingsIcon");
        settings.addEventListener("click", function () {
            document.getElementById("settingsMenu").style.display = "block";
        });
        const closeSettings = document.getElementById("closeSettings");
        closeSettings.addEventListener("click", function () {
            document.getElementById("settingsMenu").style.display = "none";
        });

        const displayTasks = document.getElementById("tasks");
        displayTasks.addEventListener("click", function () {
            document.getElementById("taskMenu").style.display = "block";
        });

        const closeTasks = document.getElementById("closeTasks");
        closeTasks.addEventListener("click", function () {
            document.getElementById("taskMenu").style.display = "none";
        })

        const volumeIcon = document.getElementById("volumeIcon");
        volumeIcon.addEventListener("click", mute());

        // deciding on which theme to use
        loadData();
    }

    /* save user's preference locally after theme changing */
    function loadData() {
        let theme = window.localStorage.getItem("theme");
        const app = document.getElementById("brackground");
        if (!theme) {
            app.className = "potatoTheme";
            window.localStorage.setItem("theme", "potato");
            console.log("null");
        } else if (theme == "potato"){
            potatoTheme();
            window.localStorage.setItem("theme", "potato");
            console.log("potato");
        } else if (theme == "dark"){
            darkTheme();
            window.localStorage.setItem("theme", "dark");
            console.log("dark");
        } else if (theme == "light"){
            lightTheme();
            window.localStorage.setItem("theme", "light");
            console.log("light");
        }
    }
    
    function potatoTheme() {
        window.localStorage.setItem("theme", "potato");
        const body = document.getElementById("background");
        body.className = "potatoTheme";

        let circle = document.getElementById("circleTimer");
        circle.style.backgroundColor = "#ff0";
        circle.style["boxShadow"] = "0 0 20px 20px #ff0";
        circle.style.border = "5px solid #ff0";

        /* buttons */
        let btn = document.getElementsByTagName("button");
        for(let i = 0; i < btn.length; i ++) {
            if(btn[i].classList.contains("darkButton")) {
                btn[i].classList.remove("darkButton");
            }
        }

        /* settings menu */
        let settings = document.getElementById("settingsMenu");
        settings.classList.add("menuLight");
        if(settings.classList.contains("darkTheme")) {
            settings.classList.remove("darkTheme");
        }

        // Task Menu 
        let tasks = document.getElementById("taskMenu");
        tasks.classList.add("menuLight");
        if(tasks.classList.contains("darkTheme")) {
            tasks.classList.remove("darkTheme");
        }

        settings.style.display = "none";
    }

    function darkTheme() {
        window.localStorage.setItem("theme", "dark");
        const body = document.getElementById("background");
        body.className = "darkTheme";

        let circle = document.getElementById("circleTimer");
        circle.style.backgroundColor = "#333";
        circle.style["boxShadow"] = "0 0 10px 10px white";
        circle.style.border = "5px solid white";

        /* buttons */
        let btn = document.getElementsByTagName("button");
        for(let i = 0; i < btn.length; i ++) {
            btn[i].className = "darkButton";
        }

        /* settings menu */
        let settings = document.getElementById("settingsMenu");
        settings.classList.add("darkTheme");
        if(settings.classList.contains("menuLight")) {
            settings.classList.remove("menuLight");
        }

        // Task Menu 
        let tasks = document.getElementById("taskMenu");
        tasks.classList.add("darkTheme");
        if(tasks.classList.contains("menuLight")) {
            tasks.classList.remove("menuLight");
        }

        settings.style.display = "none";
    }

    function lightTheme() {
        window.localStorage.setItem("theme", "light");
        const body = document.getElementById("background");
        body.className = "lightTheme";
        let circle = document.getElementById("circleTimer");
        circle.style.backgroundColor = "white";
        circle.style["boxShadow"] = "0 0 10px 10px #333";
        circle.style.border = "5px solid #333";

        /* resset and start button */
        let btn = document.getElementsByTagName("button");
        for(let i = 0; i < btn.length; i ++) {
            if(btn[i].classList.contains("darkButton")) {
                btn[i].classList.remove("darkButton");
            }
        }

        /* settings menu */
        let settings = document.getElementById("settingsMenu");
        settings.classList.add("menuLight");
        if(settings.classList.contains("darkTheme")) {
            settings.classList.remove("darkTheme");
        }

        // Task Menu 
        let tasks = document.getElementById("taskMenu");
        tasks.classList.add("menuLight");
        if(tasks.classList.contains("darkTheme")) {
            tasks.classList.remove("darkTheme");
        }

        settings.style.display = "none";
   }

    function displayTasks() {
        document.getElementById("taskMenu").style.display = "block";
    }

    function mute() {
        const volumeIcon = document.getElementById("volumeIcon");
        volumeIcon.src = "img/volume-mute.png";
        const volume = document.getElementById("volume");
        volume.value = 0;
    }
</script>
